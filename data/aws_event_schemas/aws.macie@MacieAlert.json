{
  "openapi": "3.0.0",
  "info": {
    "version": "1.0.0",
    "title": "MacieAlert"
  },
  "paths": {},
  "components": {
    "schemas": {
      "AWSEvent": {
        "type": "object",
        "required": [
          "detail-type",
          "resources",
          "id",
          "source",
          "time",
          "detail",
          "region",
          "version",
          "account"
        ],
        "x-amazon-events-detail-type": "Macie Alert",
        "x-amazon-events-source": "aws.macie",
        "properties": {
          "detail": {
            "$ref": "#/components/schemas/MacieAlert"
          },
          "detail-type": {
            "type": "string"
          },
          "resources": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "id": {
            "type": "string"
          },
          "source": {
            "type": "string"
          },
          "time": {
            "type": "string",
            "format": "date-time"
          },
          "region": {
            "type": "string"
          },
          "version": {
            "type": "string"
          },
          "account": {
            "type": "string"
          }
        }
      },
      "MacieAlert": {
        "type": "object",
        "required": [
          "actor",
          "risk-score",
          "notification-type",
          "name",
          "created-at",
          "trigger",
          "url",
          "tags",
          "alert-arn"
        ],
        "properties": {
          "summary": {
            "$ref": "#/components/schemas/Summary"
          },
          "trigger": {
            "$ref": "#/components/schemas/Trigger"
          },
          "actor": {
            "type": "string"
          },
          "risk-score": {
            "type": "number"
          },
          "notification-type": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "created-at": {
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "alert-arn": {
            "type": "string"
          }
        }
      },
      "Summary": {
        "type": "object",
        "properties": {
          "DLP-risk": {
            "$ref": "#/components/schemas/DLP-risk"
          },
          "Owner": {
            "$ref": "#/components/schemas/Owner"
          },
          "IP": {
            "$ref": "#/components/schemas/IP"
          },
          "ACL": {
            "$ref": "#/components/schemas/ACL"
          },
          "Themes": {
            "$ref": "#/components/schemas/Themes"
          },
          "Timestamps": {
            "$ref": "#/components/schemas/Timestamps"
          },
          "Events": {
            "$ref": "#/components/schemas/Events"
          },
          "Bucket": {
            "$ref": "#/components/schemas/Bucket"
          },
          "recipientAccountId": {
            "$ref": "#/components/schemas/RecipientAccountId"
          },
          "Object": {
            "$ref": "#/components/schemas/Object"
          },
          "Location": {
            "$ref": "#/components/schemas/Location"
          },
          "Source ARN": {
            "type": "string"
          },
          "Description": {
            "type": "string"
          },
          "Time Range": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SummaryItem"
            }
          },
          "Record-Count": {
            "type": "number"
          },
          "Event-Count": {
            "type": "number"
          }
        }
      },
      "Trigger": {
        "type": "object",
        "required": [
          "alert-type"
        ],
        "properties": {
          "features": {
            "$ref": "#/components/schemas/Features"
          },
          "rule-arn": {
            "type": "string"
          },
          "alert-type": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "created-at": {
            "type": "string"
          },
          "risk": {
            "type": "number"
          }
        }
      },
      "DLP-risk": {
        "type": "object",
        "properties": {
          "7": {
            "type": "number"
          }
        }
      },
      "Owner": {
        "type": "object",
        "properties": {
          "bucket_owner": {
            "type": "number"
          }
        }
      },
      "IP": {
        "type": "object",
        "properties": {
          "72.21.196.70": {
            "type": "number"
          },
          "34.205.153.2": {
            "type": "number"
          },
          "34.199.185.34": {
            "type": "number"
          }
        }
      },
      "ACL": {
        "type": "object",
        "properties": {
          "secret-bucket-name": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ACLItem"
            }
          }
        }
      },
      "Themes": {
        "type": "object",
        "properties": {
          "Secret Markings": {
            "type": "number"
          },
          "Confidential Markings": {
            "type": "number"
          },
          "Corporate Proposals": {
            "type": "number"
          }
        }
      },
      "Timestamps": {
        "type": "object",
        "properties": {
          "2017-04-03T16:12:53+00:00": {
            "type": "number"
          },
          "2017-01-10T22:48:06.784937": {
            "type": "number"
          }
        }
      },
      "Events": {
        "type": "object",
        "properties": {
          "GetBucketLocation": {
            "$ref": "#/components/schemas/GetBucketLocation"
          },
          "GetBucketAcl": {
            "$ref": "#/components/schemas/GetBucketLocation"
          },
          "ListBuckets": {
            "$ref": "#/components/schemas/GetBucketLocation"
          },
          "GetBucketPolicy": {
            "$ref": "#/components/schemas/GetBucketPolicy"
          },
          "ListRoles": {
            "$ref": "#/components/schemas/GetBucketLocation"
          }
        }
      },
      "Bucket": {
        "type": "object",
        "properties": {
          "secret-bucket-name": {
            "type": "number"
          }
        }
      },
      "RecipientAccountId": {
        "type": "object",
        "properties": {
          "123456789012": {
            "type": "number"
          }
        }
      },
      "Object": {
        "type": "object",
        "properties": {
          "public_bucket/financial_summary.txt": {
            "type": "number"
          },
          "public_bucket/secret_key.txt": {
            "type": "number"
          }
        }
      },
      "Location": {
        "type": "object",
        "properties": {
          "us-east-1": {
            "type": "number"
          }
        }
      },
      "SummaryItem": {
        "type": "object",
        "nullable": true,
        "required": [
          "count",
          "start",
          "end"
        ],
        "properties": {
          "count": {
            "type": "number",
            "nullable": true
          },
          "start": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "end": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "Features": {
        "type": "object",
        "properties": {
          "distinctEventName": {
            "$ref": "#/components/schemas/DistinctEventName"
          },
          "ListInstanceProfilesForRole": {
            "$ref": "#/components/schemas/ListInstanceProfilesForRole"
          },
          "ListRolePolicies": {
            "$ref": "#/components/schemas/ListInstanceProfilesForRole"
          }
        }
      },
      "ACLItem": {
        "type": "object",
        "nullable": true,
        "required": [
          "Owner",
          "Grants"
        ],
        "properties": {
          "Owner": {
            "$ref": "#/components/schemas/Owner_1"
          },
          "Grants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ACLItemItem"
            }
          }
        }
      },
      "GetBucketLocation": {
        "type": "object",
        "properties": {
          "ISP": {
            "$ref": "#/components/schemas/ISP"
          },
          "count": {
            "type": "number"
          }
        }
      },
      "GetBucketPolicy": {
        "type": "object",
        "properties": {
          "ISP": {
            "$ref": "#/components/schemas/ISP"
          },
          "Error-Code": {
            "$ref": "#/components/schemas/Error-Code"
          },
          "count": {
            "type": "number"
          }
        }
      },
      "DistinctEventName": {
        "type": "object",
        "properties": {
          "narrative": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "risk": {
            "type": "number"
          }
        }
      },
      "ListInstanceProfilesForRole": {
        "type": "object",
        "properties": {
          "multiplier": {
            "type": "number",
            "format": "double"
          },
          "narrative": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "risk": {
            "type": "number"
          },
          "anomalous": {
            "type": "boolean"
          },
          "excession_times": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          }
        }
      },
      "Owner_1": {
        "type": "object",
        "nullable": true,
        "required": [
          "DisplayName",
          "ID"
        ],
        "properties": {
          "DisplayName": {
            "type": "string",
            "nullable": true
          },
          "ID": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ACLItemItem": {
        "type": "object",
        "nullable": true,
        "required": [
          "Grantee",
          "Permission"
        ],
        "properties": {
          "Grantee": {
            "$ref": "#/components/schemas/Grantee"
          },
          "Permission": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ISP": {
        "type": "object",
        "properties": {
          "Amazon": {
            "type": "number"
          }
        }
      },
      "Error-Code": {
        "type": "object",
        "properties": {
          "NoSuchBucketPolicy": {
            "type": "number"
          }
        }
      },
      "Grantee": {
        "type": "object",
        "nullable": true,
        "required": [
          "Type",
          "URI"
        ],
        "properties": {
          "Type": {
            "type": "string",
            "nullable": true
          },
          "URI": {
            "type": "string",
            "nullable": true
          }
        }
      }
    }
  }
}
